"use strict";function handlersRequest(){$(".btn-request-accept").on("click",function(e){e.preventDefault();var t=$(this).parent();$.ajax({method:"POST",url:"/requests/accept",dataType:"json",data:{requestId:$(this).parent().attr("data-request-id")},success:function(e){"ok"===e.status?(t.find("p").remove(),t.find(".in-pos, .in-neg, .in-com").remove(),t.append($('<p class="got-number">Вы можете связаться с румейтом по телефону: '+e.phone+"</p>")),t.append($('<a class="in-pos">Одобрено</a>'))):alert("При одобрении заявки произошла ошибка")},error:function(){alert("Проверьте соединение с Интернетом")}})}),$(".btn-request-decline").on("click",function(e){e.preventDefault();var t=$(this).parent();$.ajax({method:"POST",url:"/requests/decline",dataType:"json",data:{requestId:$(this).parent().attr("data-request-id")},success:function(e){"ok"===e.status?(t.find("p").remove(),t.find(".in-pos, .in-neg, .in-com").remove(),t.append($('<a class="in-neg">Отклонено</a>'))):alert("При отклонении заявки произошла ошибка")},error:function(){alert("Проверьте соединение с Интернетом")}})}),$(".btn-complain").on("click",function(e){e.preventDefault(),$(".complain-form").attr("data-complain-to-user-id",$(this).parent().attr("data-user-id")),$(".complain-form > select > option").each(function(e){0===e?$(this).prop("selected",!0):$(this).prop("selected",!1)}),$(".complain-form > textarea").val(""),$("#btn-send-complain").off("click"),$("#btn-send-complain").on("click",function(e){return e.preventDefault(),$("#complain-comment").val().length>500?(alert("Длина поля 'Комментарий' не может превышать 500 символов"),void $("#complain-comment").focus()):void $.ajax({method:"POST",url:"/requests/complain/",data:{user_id:$(this).parent().attr("data-complain-to-user-id"),complain_id:processInputSelect("complain-reason"),complain_comment:$("#complain-comment").val()},success:function(e){"ok"===e.status?(alert("Ваша жалоба принята. Нам очень важна Ваша активность. Спасибо!"),closePopup()):"NO_AVAILABLE_COMPLAINS"===e.reason?(alert("Вы отправили максимальное количество жалоб на этой неделе"),closePopup()):"COMPLAIN_IS_ALREADY_EXISTS"===e.reason?(alert("Вы уже отправляли жалобу на этого пользователя"),closePopup()):(alert("При подаче жалобы произошла ошибка. Наверное Вы пожаловались на сына/дочку мэра. Извините, за Вами уже выехали."),closePopup())},error:function(e){alert("Ошибка сетевого соединения"),closePopup()}})}),showPopup()})}function processInputSelect(e,t){var n,a=$("#"+e+">option");return n=t?null:a.eq(0).val(),a.each(function(e){return!$(this).prop("selected")||t&&0===e?void 0:(n=$(this).val(),!1)}),n}$(document).ready(function(){handlersRequest()});